package ru.tomtrix.ttf

import org.eclipse.swt.widgets.{Shell, Display}
import ru.tomtrix.ttf.SWTWrappers._
import ru.tomtrix.ttf.patterns.Disposable._
import ru.tomtrix.ttf.controls.ExtendedShell._
import ru.tomtrix.ttf.patterns.{Repository, Akka}

object Exploit {
  def exploitAkka(sysName: String)(f: Akka => Unit) {
    using(new Akka{val name = sysName})(f)
  }

  def exploitDb(dbmsname: DBMS, dbname: String)(f: Repository => Unit) {
    using(new Repository {val db: String = dbname; val dbms: DBMS = dbmsname})(f)
  }

  def exploitSplash(splashname: String, splashtext: String, splashtimeMillis: Int)(f: Shell => Unit) {
    showSplashScreenFuncTime(splashname, text = splashtext, millisec = splashtimeMillis)(f)
  }

  def exploitForm(title: String, pack: Boolean = true, toCenter: Boolean = true)(f: Shell => Unit) {
    val display = new Display()
    val shell = new Shell(display)
    shell setText title
    f(shell)
    if (pack) shell pack 20
    if (toCenter) putToCenter(shell)
    shell.open()
    while (!shell.isDisposed)
      if (!display.readAndDispatch()) display sleep()
  }
}
